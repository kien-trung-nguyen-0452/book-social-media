version: '3.8'         # 1ï¸âƒ£ PhiÃªn báº£n docker-compose syntax

services:              # 2ï¸âƒ£ CÃ¡c service cáº§n cháº¡y
  mysql-db:            # ğŸ‘‰ Service MySQL (database)
    image: mysql:8.0
    container_name: auth-mysql-db
    restart: always
    environment:       # ğŸ‘‰ CÃ¡c biáº¿n mÃ´i trÆ°á»ng cho MySQL
      MYSQL_ROOT_PASSWORD: root
      MYSQL_DATABASE: auth_service
      MYSQL_USER: kien
      MYSQL_PASSWORD: 123456789
    ports:
      - "3307:3306"     # ğŸ‘‰ Expose MySQL port 3306 bÃªn trong => 3307 bÃªn ngoÃ i
    volumes:            # ğŸ‘‰ Gáº¯n á»• Ä‘Ä©a Ä‘á»ƒ lÆ°u database
      - auth_mysql_data:/var/lib/mysql

  auth-service:     # ğŸ‘‰ Service Spring Boot (API cá»§a báº¡n)
    build: .            # ğŸ‘‰ Build tá»« Dockerfile á»Ÿ thÆ° má»¥c hiá»‡n táº¡i
    container_name: auth-service
    ports:
      - "8080:8080"     # ğŸ‘‰ Expose port 8080
    environment:        # ğŸ‘‰ Inject biáº¿n mÃ´i trÆ°á»ng Ä‘á»ƒ app Ä‘á»c
      DBMS_CONNECTION: jdbc:mysql://mysql-db:3306/auth_service?user=kien
      DBMS_USERNAME: kien
      DBMS_PASSWORD: 123456789
    depends_on:         # ğŸ‘‰ Phá»¥ thuá»™c: chá» mysql-db start trÆ°á»›c
      - mysql-db

volumes:                # 3ï¸âƒ£ Khai bÃ¡o volumes
  auth_mysql_data:
